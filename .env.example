# ================================
# Xlog Stack
# Matches environment variables in docker-compose.yml
# ================================

# Cortex XSIAM PAPI credentials and command excution case id (required by the MCP server)
CORTEX_MCP_PAPI_URL=https://api-your-tenant.xdr.region.paloaltonetworks.com
CORTEX_MCP_PAPI_AUTH_HEADER=your_papi_auth_header
CORTEX_MCP_PAPI_AUTH_ID=your_papi_auth_id
PLAYGROUND_ID=156086

# MCP transport configuration (used by the server container)
MCP_TRANSPORT=streamable-http
MCP_HOST=0.0.0.0
MCP_PORT=8080
MCP_PATH=/api/v1/stream/mcp
MCP_TOKEN=your_mcp_bearer_token

# SSL/TLS (PEM content on one line; use \\n for newlines)
SSL_CERT_PEM=-----BEGIN CERTIFICATE-----\\n...\\n-----END CERTIFICATE-----
SSL_KEY_PEM=-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----

# Model name and credentials
# Use either GEMINI_API_KEY (for API key auth) OR GOOGLE_APPLICATION_CREDENTIALS (for service account auth)
GEMINI_API_KEY=your_gemini_api_key
GOOGLE_APPLICATION_CREDENTIALS=content_of_service_account.json
GEMINI_MODEL=gemini-3-pro-preview


# MCP client settings 
MCP_URL=https://mcp-host:9020/api/v1/stream/mcp
UI_USER=username
UI_PASSWORD=strong_password

# Rebuild Examples RAG DB
REBUILD_XQL_CHROMA=true

# XSIAM Webhook
WEBHOOK_ENDPOINT=https://api-your-tenant.xdr.region.paloaltonetworks.com/logs/v1/event
WEBHOOK_KEY=your_webhook_key

# Caldera Access
CALDERA_URL=http://calderahost:8888
CALDERA_API_KEY=your_caldera_api_key

# Xlog settings
WORKERS_NUMBER=25
LOGGING_DIR=logs
LOGGING_STORAGE_SIZE=10M
LOGGING_TRUNCATE_LIMIT=100
XSIAM_MANDATORY_PARSED_FIELDS=remote_ip,remote_port,local_ip,local_port,event_timestamp,severity,alert_name
XSIAM_OPTIONAL_PARSED_FIELDS=alert_description,action_status,local_ip_v6,remote_ip_v6

# Technology Stack Configuration (JSON format)
# Defines the organization's security stack and default log destination
# The agent will use log_destination.full_address as the default destination when user doesn't specify one
TECHNOLOGY_STACK={"stack_name": "Enterprise Security Stack", "log_destination": {"type": "syslog", "protocol": "udp", "host": "10.10.0.8", "port": 514, "full_address": "udp:10.10.0.8:514"}, "vendors": [{"vendor": "Fortinet", "product": "FortiGate", "category": "Firewall", "formats": ["CEF", "SYSLOG", "JSON"], "description": "Next-Generation Firewall"}, {"vendor": "CrowdStrike", "product": "Falcon", "category": "EDR", "formats": ["JSON"], "description": "Endpoint Detection and Response"}, {"vendor": "F5", "product": "ASM", "category": "WAF", "formats": ["CEF", "JSON"], "description": "Application Security Manager"}]}

# Force skills sync on MCP client startup
FORCE_SKILLS_SYNC=1